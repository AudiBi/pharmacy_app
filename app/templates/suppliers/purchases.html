{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Historique des achats</h2>
  <p>
    <strong>Fournisseur :</strong> {{ supplier.name }}<br>
    {% if supplier.contact %}<strong>Contact :</strong> {{ supplier.contact }}<br>{% endif %}
    {% if supplier.address %}<strong>Adresse :</strong> {{ supplier.address }}{% endif %}
  </p>
  <a href="{{ url_for('supplier.list_suppliers') }}" class="btn btn-secondary mb-3">← Retour à la liste des fournisseurs</a>

  {% if purchases %}
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>ID Achat</th>
        <th>Date</th>
        <th>Total (HTG)</th>
        <th>Médicaments</th>
        <th>Détails</th>
      </tr>
    </thead>
    <tbody>
      {% for purchase in purchases %}
      <tr>
        <td>{{ purchase.id }}</td>
        <td>{{ purchase.purchase_date.strftime('%Y-%m-%d') }}</td>
        <td>{{ '%.2f'|format(purchase.total_amount) }}</td>
        <td>
          {% if purchase.medications %}
            {{ purchase.medications|join(', ') }}
          {% else %}
            —
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('purchase.view_purchase', purchase_id=purchase.id) }}" class="btn btn-sm btn-info">
            Voir
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <div class="alert alert-info">
      Aucun achat trouvé pour ce fournisseur.
    </div>
  {% endif %}
</div>
{% endblock %}
