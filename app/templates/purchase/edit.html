<!-- {% extends 'base.html' %}
{% block content %}
<h2>{{ 'Modifier' if form._obj else 'Ajouter' }} une entr√©e d'achat</h2>

<form method="POST">
    {{ form.hidden_tag() }}

    <div class="mb-3">
        {{ form.supplier_id.label }} {{ form.supplier_id(class="form-select") }}
    </div>
    <div class="mb-3">
        {{ form.drug_id.label }} {{ form.drug_id(class="form-select") }}
    </div>
    <div class="mb-3">
        {{ form.quantity.label }} {{ form.quantity(id="quantity", class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.unit_price.label }} {{ form.unit_price(id="unit_price", class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.total_cost.label }} {{ form.total_cost(id="total_cost", class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.purchase_date.label }} {{ form.purchase_date(class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.commentaire.label }} {{ form.commentaire(class="form-control") }}
    </div>

    <button type="submit" class="btn btn-success">{{ 'Modifier' if form._obj else 'Ajouter' }}</button>
    <a href="{{ url_for('purchase.list_purchases') }}" class="btn btn-secondary">Annuler</a>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const qty = document.getElementById('quantity');
    const unitPrice = document.getElementById('unit_price');
    const totalCost = document.getElementById('total_cost');

    function updateTotal() {
        const q = parseFloat(qty.value) || 0;
        const up = parseFloat(unitPrice.value) || 0;
        totalCost.value = (q * up).toFixed(2);
    }

    qty.addEventListener('input', updateTotal);
    unitPrice.addEventListener('input', updateTotal);
});
</script>

{% endblock %} -->
